# Snakefile

import os
import glob

current_path = os.getcwd()

# Extract sample names and their suffixes from files with "_R1" in the raw data directory
raw_data_dir = config["rawdatadir"]
R1_files = glob.glob(os.path.join(raw_data_dir, '*_R1*'))

# Create a dictionary to store the sample names and their suffixes
sample_suffixes = {}
for f in R1_files:
    basename = os.path.basename(f)
    sample = basename.split('_R1')[0]
    suffix = basename.split('_R1')[1]
    sample_suffixes[sample] = suffix

# Generate a list of samples
SAMPLES = list(sample_suffixes.keys())

rule all:
    input:
        os.path.join(current_path, "results", "00-prepare", config["outputprepare"] + ".fasta"),
        os.path.join(current_path, "results", "00-prepare", config["outputprepare"] + "_withSingleton.fasta")

include: "rules/adapter_removal_and_pear.smk"
include: "rules/prinseq_concatenate_relabel.smk"
include: "rules/prinseq_concatenate_relabel_singleton.smk"